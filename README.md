# Задача для программиста С# (микросервис)

> Версия 20230907

## Задача

Создать два приложения:

### Первое приложение

Первое приложение — это микросервис, который должен содержать три эндпоинта:

#### POST /add

Эндпоинт позволяет ввести в разговор нового пользователя, либо продолжить беседу

##### Тело запроса

```json
{
    "name": "имя_пользователя",
    "message": "текст_сообщения_от_пользователя"
}
```

##### Ответ

```json
{
    "status": 1, // Статус - успешно
    "user_id": 1 // Порядковый идентификатор пользователя
}
```

##### Пример 1

```json
{
    "name": "John",
    "message": "Hello!"
}

// Ответ:

{
    "status": 1,
    "user_id": 1 // т.е. John стал первым!
}

```

##### Пример 2

```json
{
    "name": "Ann",
    "message": "Ola!"
}

// Ответ:

{
    "status": 1,
    "user_id": 2 // Т.к. Ann - это уже второй пользователь
}

```

##### Пример 3

```json
{
    "name": "John",
    "message": "How R U?"
}

// Ответ:

{
    "status": 1,
    "user_id": 1 // помним, что John все еще первый!
}

```

#### GET /list/{user_id}

Эндпоинт выводит все сообщения от указанного пользователя (user_id). Если user_id не задан, то вывести все сообщения от всех пользователей. Если пользователь с заданым идентификатором не найден, то вернуть соответствующий статус.

##### Запрос

> GET /list/3

##### Ответ

```json
{
    "status": 2 // Статус - пользователь не найден
}
```

##### Запрос

> GET /list/2

##### Ответ

```json
{
    "status": 1, // Статус - успешно
    "name": "Ann",
    "messages": [ "Ola!" ]
}
```

##### Запрос

> GET /list/1

##### Ответ

```json
{
    "status": 1, // Статус - успешно
    "name": "John",
    "messages": [ "Hello!", "How R U?" ]
}
```

##### Запрос

> GET /list

##### Ответ

```json
{
    "status": 1, // Статус - успешно
    [
        {
            "name": "John",
            "messages": [ "Hello!" ]
        },
        {
            "name": "Ann",
            "messages": [ "Ola!" ]
        },
        {
            "name": "John",
            "messages": [ "How R U?" ]
        }
    ]
}
```

#### DELETE /delete/{user_id}

Эндпоинт позволяет удалить пользователя и все его сообщения!

##### Запрос

> DELETE /delete/3

##### Ответ

```json
{
    "status": 2 // Статус - пользователь не найден
}
```

##### Запрос

> DELETE /delete/2

##### Ответ

```json
{
    "status": 1 // Статус - пользователь удален! В данном случае - Ann
}
```

Если после удаления вызвать метод list, то Ann уже должна отсутствовать:

##### Запрос

> GET /list/2

##### Ответ

```json
{
    "status": 2 // Статус - пользователь не найден
}
```

##### Запрос

> GET /list

##### Ответ

```json
{
    "status": 1, // Статус - успешно
    [
        {
            "name": "John",
            "messages": [ "Hello!" ]
        },
        {
            "name": "John",
            "messages": [ "How R U?" ]
        }
    ]
}
```

### Второе приложение

Реализация этого приложения на ваше усмотрение — консольное приложение на C#, либо простая html-страница, либо последовательный набор запросов в программе Postman. Пойдет даже командный файл с вызовами CURL.

Цель приложения — вызов эндпоинтов микросервиса с разным набором данных.

## Требования к реализации

- Первое приложение (микросервис) сделать на платформе `.NET 7.0`
- С учетом загруженности задача дается на срок от 2-х до 7-ми дней, но можно прислать раньше по мере готовности
- Как хранить данные на стороне микросервиса решите на свое усмотрение, можно в БД, можно в файле, да хоть в памяти
- Для второго приложения предпочтительнее вариант с консольным приложением на C#, но если реализуете несколько вариантов, то будет огромным плюсом!
- По возможности в важные участки кода добавить комментарии

## Также будет плюсом

В корень проекта приложить `readme.md` в котором:

- Можно указать реальное время, которое затратили на реализацию
- Кратко опишите как работает ваше решение: порядок запуска и другие вещи и мысли, которые посчитаете нужными и полезными

Огромным плюсом будет:

- Если в `readme.md` опишите, как можно мониторить работоспособность микросервисной части проекта (например, `Prometheus`)
- Если сделаете `логирование` операций в микросервисе
- Если добавите в микросервис `Swagger`
- Подготовите `юнит-тесты` для микросервиса

**Пять с плюсом за задачу со звездочкой:**

В корне приложения создайте `.gitlab-ci.yml` файл, который должен содержать синтаксис для деплоя микросервиса на тестовую и боевую схему.

Данные для тестовой схемы:

- Название шага `Stage`
- Адрес MS Deploy `https://10.20.30.40:8172/msdeploy.axd`
- Название пула приложения `testms`
- Имя конфигурации публикации `stage`
- техническая учетка для публикации `WEB-USER-01` с паролем `LuckyWay`

Данные для боевой схемы:

- Название шага `Prod`
- Адрес MS Deploy `https://10.20.30.80:8172/msdeploy.axd`
- Название пула приложения `ms`
- Имя конфигурации публикации `prod`
- техническая учетка для публикации `WEB-USER-02` с паролем `Weird213jK`

## По итогам реализации

- Упакуйте весь проект в единый архив и вышлите его на электронную почту вашему HR-менеджеру БКС
- Либо выложите решение на GitHub в ваш аккаунт и пришлите нам ссылку на этот репозиторий через вашего HR-менеджера БКС

**Спасибо и удачи в работе!**
